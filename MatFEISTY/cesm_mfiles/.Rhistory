se2PDO$lag <- as.factor(se2PDO$lag)
rse2PDO <- melt(se2PDO)
names(rse2PDO) <- c("Lag","Type","Corr")
se2AMO <- subset(sigSE, climate=="AMO")
se2AMO <- se2AMO[,c("lag","rTP","rZ","rLos","rF","rP","rTB","rDet","rB","rD")]
names(se2AMO) <- c("lag","TP","LZ","LZm","F","P","TB","Det","B","D")
se2AMO$lag <- as.factor(se2AMO$lag)
rse2AMO <- melt(se2AMO)
names(rse2AMO) <- c("Lag","Type","Corr")
###====== Plots ===================================================================
## CCE
c0 <- ggplot(data = rcce1NOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
c1 <- ggplot(data = rcce1PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
c2 <- ggplot(data = rcce1SOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="SOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
c3 <- ggplot(data = rcce2NOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
c4 <- ggplot(data = rcce2PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
c5 <- ggplot(data = rcce2SOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="SOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
png(paste0(figp,'Heatmaps_CCE_corr_clims_fish_inputs.png'),
width = 10*300,        # 5 x 300 pixels
height = 6*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( c0,c1,c2,c3,c4,c5,
nrow = 2, ncol = 3,
rel_widths = c(1,1), rel_heights = c(1,1,1) ,
align = 'h' )#, labels = "auto", label_size = 12, hjust = -4)
dev.off()
## EBS
e0 <- ggplot(data = rebs1NOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
e1 <- ggplot(data = rebs1PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
e2 <- ggplot(data = rebs1SOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="SOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
e3 <- ggplot(data = rebs2NOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
e4 <- ggplot(data = rebs2PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
e5 <- ggplot(data = rebs2SOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="SOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
png(paste0(figp,'Heatmaps_EBS_corr_clims_fish_inputs.png'),
width = 10*300,        # 5 x 300 pixels
height = 6*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( e0,e1,e2,e3,e4,e5,
nrow = 2, ncol = 3,
rel_widths = c(1,1), rel_heights = c(1,1,1) ,
align = 'h' )#, labels = "auto", label_size = 12, hjust = -4)
dev.off()
## GAK
g0 <- ggplot(data = rgak1NOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
g1 <- ggplot(data = rgak1PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
g2 <- ggplot(data = rgak1MEI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="MEI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
g3 <- ggplot(data = rgak2NOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
g4 <- ggplot(data = rgak2PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
g5 <- ggplot(data = rgak2MEI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="MEI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
png(paste0(figp,'Heatmaps_GAK_corr_clims_fish_inputs.png'),
width = 10*300,        # 5 x 300 pixels
height = 6*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( g0,g1,g2,g3,g4,g5,
nrow = 2, ncol = 3,
rel_widths = c(1,1), rel_heights = c(1,1,1) ,
align = 'h' )#, labels = "auto", label_size = 12, hjust = -4)
dev.off()
## HI
h0 <- ggplot(data = rhi1Nino3, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="Nino3\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
h1 <- ggplot(data = rhi1Nino4, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="Nino4\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
h2 <- ggplot(data = rhi1NOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
h3 <- ggplot(data = rhi2Nino3, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="Nino3\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
h4 <- ggplot(data = rhi2Nino4, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="Nino4\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
h5 <- ggplot(data = rhi2NOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
png(paste0(figp,'Heatmaps_HI_corr_clims_fish_inputs.png'),
width = 10*300,        # 5 x 300 pixels
height = 6*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( h0,h1,h2,h3,h4,h5,
nrow = 2, ncol = 3,
rel_widths = c(1,1), rel_heights = c(1,1,1) ,
align = 'h' )#, labels = "auto", label_size = 12, hjust = -4)
dev.off()
## CHK
k0 <- ggplot(data = rchk1MEI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="MEI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
k1 <- ggplot(data = rchk1PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
k2 <- ggplot(data = rchk1AMO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="AMO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
k3 <- ggplot(data = rchk2MEI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="MEI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
k4 <- ggplot(data = rchk2PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
k5 <- ggplot(data = rchk2AMO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="AMO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
png(paste0(figp,'Heatmaps_CHK_corr_clims_fish_inputs.png'),
width = 10*300,        # 5 x 300 pixels
height = 6*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( k0,k1,k2,k3,k4,k5,
nrow = 2, ncol = 3,
rel_widths = c(1,1), rel_heights = c(1,1,1) ,
align = 'h' )#, labels = "auto", label_size = 12, hjust = -4)
dev.off()
## GMX
m0 <- ggplot(data = rgmx1AMO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="AMO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
m1 <- ggplot(data = rgmx1PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
m2 <- ggplot(data = rgmx1NOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
m3 <- ggplot(data = rgmx2AMO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="AMO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
m4 <- ggplot(data = rgmx2PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
m5 <- ggplot(data = rgmx2NOI, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NOI\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
png(paste0(figp,'Heatmaps_GMX_corr_clims_fish_inputs.png'),
width = 10*300,        # 5 x 300 pixels
height = 6*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( m0,m1,m2,m3,m4,m5,
nrow = 2, ncol = 3,
rel_widths = c(1,1), rel_heights = c(1,1,1) ,
align = 'h' )#, labels = "auto", label_size = 12, hjust = -4)
dev.off()
## SE
s0 <- ggplot(data = rse1AMO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="AMO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
s1 <- ggplot(data = rse1NAO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NAO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
s2 <- ggplot(data = rse1PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
s3 <- ggplot(data = rse2AMO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="AMO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
s4 <- ggplot(data = rse2NAO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NAO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
s5 <- ggplot(data = rse2PDO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="PDO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
png(paste0(figp,'Heatmaps_SE_corr_clims_fish_inputs.png'),
width = 10*300,        # 5 x 300 pixels
height = 6*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( s0,s1,s2,s3,s4,s5,
nrow = 2, ncol = 3,
rel_widths = c(1,1), rel_heights = c(1,1,1) ,
align = 'h' )#, labels = "auto", label_size = 12, hjust = -4)
dev.off()
## NE
n0 <- ggplot(data = rne1AMO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="AMO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
n1 <- ggplot(data = rne1NAO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NAO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
n2 <- ggplot(data = rne2AMO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="AMO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
n3 <- ggplot(data = rne2NAO, aes(y=Type, x=Lag, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="NAO\nPearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Lag, Type, label = signif(Corr,digits = 2)), color = "black", size = 3)
png(paste0(figp,'Heatmaps_NE_corr_clims_fish_inputs.png'),
width = 6.6*300,        # 5 x 300 pixels
height = 6*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( n0,n1,n2,n3,
nrow = 2, ncol = 2,
rel_widths = c(1,1), rel_heights = c(1,1,1) ,
align = 'h' )#, labels = "auto", label_size = 12, hjust = -4)
dev.off()
